# Server Configuration
port: 8317

# Authentication directory for OAuth tokens
auth-dir: "~/.cli-proxy-api"

# Enable debug logging for troubleshooting
debug: true

# Log to file (tùy chọn)
logging-to-file: false


# Amp upstream URL
amp-upstream-url: "https://ampcode.com"
amp-restrict-management-to-localhost: true

# Usage statistics
usage-statistics-enabled: false

# Proxy URL (nếu cần proxy ra internet)
# proxy-url: "socks5://user:pass@192.168.1.1:1080/"

# Retry configuration
request-retry: 3
max-retry-interval: 30

# Quota behavior - tự động chuyển khi hết quota
quota-exceeded:
  switch-project: true
  switch-preview-model: true

# WebSocket Authentication
ws-auth: false

# ============================================================================

claude-api-key:
  - api-key: "loz"
    base-url: "an-loz"
    
    # Azure-specific headers
    headers:
      anthropic-version: "2023-06-01"
      x-api-key: "loz"
    
    # Model Mappings: TẤT CẢ Claude models → claude-opus-4-5
    # Điều này đảm bảo mọi subagent đều dùng Opus 4.5
    models:
      # =====================================================
      # OPUS MODELS (Smart mode - giữ nguyên)
      # =====================================================
      - name: "claude-opus-4-5"
        alias: "claude-opus-4-5-20251101"
      - name: "claude-opus-4-5"
        alias: "claude-opus-4-5"
      - name: "claude-opus-4-5"
        alias: "claude-opus-4-1"
      
      # =====================================================
      # SONNET → OPUS (Librarian subagent dùng Sonnet)
      # =====================================================
      - name: "claude-opus-4-5"
        alias: "claude-sonnet-4-5-20250929"
      - name: "claude-opus-4-5"
        alias: "claude-sonnet-4-5"
      - name: "claude-opus-4-5"
        alias: "claude-sonnet-4"
      
      # =====================================================
      # HAIKU 4.5 → OPUS (Search subagent dùng Haiku 4.5)
      # =====================================================
      - name: "claude-opus-4-5"
        alias: "claude-haiku-4-5-20251001"
      - name: "claude-opus-4-5"
        alias: "claude-haiku-4-5"
      
      # =====================================================
      # HAIKU 3.5 → OPUS (Titling system dùng Haiku 3.5)
      # =====================================================
      - name: "claude-opus-4-5"
        alias: "claude-3-5-haiku-20241022"
      - name: "claude-opus-4-5"
        alias: "claude-3-5-haiku"
      - name: "claude-opus-4-5"
        alias: "claude-haiku-3-5"

# ============================================================================
# HƯỚNG DẪN SỬ DỤNG
# ============================================================================
#
# 1. Thay thế YOUR_AZURE_API_KEY bằng API key từ Azure AI Foundry
#
# 2. Thay thế YOUR_RESOURCE_NAME bằng resource name của bạn
#    Ví dụ: my-azure-claude.services.ai.azure.com/anthropic
#
# 3. Chạy CLIProxyAPI:
#    ./cliproxyapi -config config.oracle-to-azure-claude.yaml
#
# 4. Configure Amp CLI để sử dụng proxy:
#    export AMP_API_URL="http://localhost:8317"
#    amp prompt "use oracle to analyze this code"
#
# 5. Kiểm tra logs:
#    - Tìm "cross-provider executor" trong logs
#    - Tìm "model alias gpt-5 → claude-opus-4-5"
#
# ============================================================================
# TROUBLESHOOTING
# ============================================================================
#
# 1. "cross-provider executor: missing base URL"
#    → Kiểm tra base-url trong codex-api-key
#
# 2. "cross-provider executor: missing API key"
#    → Kiểm tra api-key trong codex-api-key
#
# 3. Model không được nhận diện:
#    → Kiểm tra models aliases trong codex-api-key
#    → Đảm bảo model alias khớp với tên Oracle sử dụng (gpt-5, gpt-5.1)
#
# 4. Azure trả về lỗi authentication:
#    → Kiểm tra x-api-key trong headers
#    → Kiểm tra anthropic-version header
#
# ============================================================================
